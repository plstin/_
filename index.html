<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>يوسف - Yousef</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background: #f0f2f5;
      color: #222;
      direction: rtl;
      text-align: right;
    }

    main {
      padding: 20px;
      max-width: 1000px;
      margin: auto;
    }

    #flagContainer {
      text-align: center;
      margin-bottom: 10px;
    }

    #flagContainer img {
      width: 60px;
      height: auto;
      border-radius: 5px;
    }

    #infoBox {
      background-color: #fff9e6;
      border-right: 5px solid #ff9900;
      padding: 15px 20px;
      border-radius: 8px;
      margin-bottom: 10px;
      font-size: 14px;
      line-height: 1.6;
    }

    #reminderLine {
      font-size: 13px;
      color: #333;
      margin-bottom: 20px;
    }

    #offerList {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 14px;
    }

    .offer-card {
      background: #fff;
      border-radius: 10px;
      padding: 10px;
      cursor: pointer;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
      transition: transform 0.2s ease;
      display: flex;
      align-items: center;
    }

    .offer-card:hover {
      transform: scale(1.02);
    }

    .offer-card img {
      width: 30%;
      height: 90px;
      object-fit: cover;
      border-radius: 8px;
      margin-left: 10px;
      flex-shrink: 0;
    }

    .offer-text {
      width: 70%;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .offer-title {
      font-size: 14px;
      font-weight: bold;
      white-space: normal;
      overflow: visible;
    }

    .offer-desc {
      display: none;
    }

    #loading {
      text-align: center;
      margin-top: 20px;
      font-size: 16px;
    }

    .no-offers {
      color: red;
      font-weight: bold;
      text-align: center;
    }

    @media (max-width: 1000px) {
      #offerList {
        grid-template-columns: repeat(3, 1fr);
      }
    }

    @media (max-width: 700px) {
      #offerList {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 400px) {
      #offerList {
        grid-template-columns: 1fr;
      }
      .offer-card {
        flex-direction: column;
        align-items: flex-start;
      }
      .offer-card img {
        width: 100%;
        margin-left: 0;
        margin-bottom: 10px;
      }
      .offer-text {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <main>
    <div id="flagContainer">
      <img src="https://upload.wikimedia.org/wikipedia/commons/0/00/Flag_of_Palestine.svg" alt="علم فلسطين">
    </div>

    <div id="infoBox">
      السلام عليكم، إسمي يوسف من فلسطين و حلمي هو أن أصبح مطورا ناجحا، لأكون مصدر فخر لوطني، فلهذا يجب علي الحصول على كمبيوتر، و يمكنكم مساعدتي عن طريق التسجيل بالمجان في المواقع أسفله، فهي تكافئني مقابل الترويج لها، الأمر لا يتطلب أكثر من دقيقة لكل موقع، كلما تسجلتم في مواقع أكثر كلما إقتربت من تحقيق حلمي، و أرجو منكم الدعاء لوالدي بالمغفرة.
    </div>

    <div id="reminderLine">
      حتى بعد إنتهاءكم من جميع التسجيلات، يمكنكم العودة لاحقا لأنني سأضيف مواقع جديدة بإستمرار
    </div>

    <div id="offerList"></div>
    <div id="loading">...</div>
  </main>

  <script>
    const offerList = document.getElementById("offerList");
    const loading = document.getElementById("loading");

    let isArabicUser = true; 

    function createOfferCard(offer) {
      const card = document.createElement("div");
      card.className = "offer-card";

      const img = document.createElement("img");
      img.src = offer.picture || "";
      card.appendChild(img);

      const textContainer = document.createElement("div");
      textContainer.className = "offer-text";

      const title = document.createElement("div");
      title.className = "offer-title";
      title.textContent = offer.name_short || offer.name;
      textContainer.appendChild(title);

      const desc = document.createElement("div");
      desc.className = "offer-desc";
      textContainer.appendChild(desc);

      card.appendChild(textContainer);
      card.onclick = () => window.open(offer.link, "_blank");

      return card;
    }

    async function fetchCPAGripOffers() {
      const offersUrl = "https://www.cpagrip.com/common/offer_feed_json.php?user_id=2439739&pubkey=23311a81282b777eab88a6d19f0d9493&tracking_id=";
      try {
        const res = await fetch(offersUrl);
        const data = await res.json();
        const list = Array.isArray(data) ? data : (data.offers || []);
        return list
          .filter(o => parseFloat(o.payout) >= 0.5)
          .filter(o => (o.adcopy || o.description || "") !== "Enter your information now for a chance to win.");
      } catch (err) {
        console.error("Fetch error CPA Grip:", err);
        return [];
      }
    }

    async function fetchOgadsOffers() {
      const apiKey = "34829|nJfCK9PNtqv8s0cqEl943LhDfd3ufQMGcNc2ZdCT429ec4af";
      try {
        const ipResponse = await fetch("https://api.ipify.org?format=json");
        const ipData = await ipResponse.json();
        const userIp = ipData.ip;
        const userAgent = navigator.userAgent;

        const apiUrl = new URL("https://unlockcontent.net/api/v2");
        apiUrl.searchParams.append("ip", userIp);
        apiUrl.searchParams.append("user_agent", userAgent);
        apiUrl.searchParams.append("limit", "1000");
        apiUrl.searchParams.append("ctype", "0");

        const response = await fetch(apiUrl, {
          headers: {
            Authorization: `Bearer ${apiKey}`,
          },
        });

        if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);

        const data = await response.json();
        if (!data.offers) return [];

        return data.offers
          .filter(o => parseFloat(o.payout) >= 0.5)
          .filter(o => (o.adcopy || o.description || "") !== "Enter your information now for a chance to win.");
      } catch (err) {
        console.error("Fetch error OGAds:", err);
        return [];
      }
    }

    async function loadOffers() {
      loading.style.display = "block";
      try {
        const [cpagripOffers, ogadsOffers] = await Promise.all([fetchCPAGripOffers(), fetchOgadsOffers()]);
        const allOffers = [...cpagripOffers, ...ogadsOffers];
        if (!allOffers.length) {
          if (isArabicUser) {
            offerList.innerHTML = "<p class='no-offers'>لا توجد عروض متاحة حالياً.</p>";
          } else {
            offerList.innerHTML = "<p class='no-offers'>No offers available right now.</p>";
          }
          return;
        }
        const sortedOffers = allOffers.sort((a, b) => parseFloat(b.payout) - parseFloat(a.payout));
        sortedOffers.forEach(offer => {
          const card = createOfferCard(offer);
          offerList.appendChild(card);
        });
      } finally {
        loading.style.display = "none";
      }
    }

    async function adjustForLanguage() {
      try {
        const res = await fetch("https://ipapi.co/json/");
        const data = await res.json();
        const countryCode = data.country_code;

        const arabicCountries = [
          "PS","SA","AE","EG","MA","DZ","TN","LY","SD","KW","QA","BH","OM","YE","IQ","JO","LB","SY","MR","SO","DJ","KM"
        ];

        if (!arabicCountries.includes(countryCode)) {
          isArabicUser = false; 
          const infoBox = document.getElementById("infoBox");
          const reminder = document.getElementById("reminderLine");

          infoBox.innerHTML = 
            `Hello, my name is Yousef from Palestine. My dream is to become a successful developer 
            and make my country proud. To achieve this, I need a computer.  
            You can support me by registering for free on the websites below.  
            Each registration helps me get closer to my dream.  
            I also kindly ask you to pray for my parents.`;

          reminder.textContent = 
            "Even after you finish all registrations, you can come back later because I will keep adding new sites.";

          infoBox.style.direction = "ltr";
          infoBox.style.textAlign = "left";
          reminder.style.direction = "ltr";
          reminder.style.textAlign = "left";

          infoBox.style.borderRight = "none";
          infoBox.style.borderLeft = "5px solid #ff9900";
        }
      } catch (err) {
        console.error("Geolocation error:", err);
      }
    }

    adjustForLanguage().then(loadOffers);
  </script>
</body>
</html>
