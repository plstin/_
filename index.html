<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>OGAds Offerwall</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background: #f0f2f5;
      color: #222;
      direction: rtl; /* right-to-left */
      text-align: right; /* align text to right */
    }

    main {
      padding: 20px;
      max-width: 1000px;
      margin: auto;
    }

    /* Flag container */
    #flagContainer {
      text-align: center;
      margin-bottom: 10px;
    }

    #flagContainer img {
      width: 60px; /* adjust size */
      height: auto;
      border-radius: 5px;
    }

    /* Info Box */
    #infoBox {
      background-color: #fff9e6; /* light yellow */
      border-right: 5px solid #ff9900; /* bright orange accent line */
      padding: 15px 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 14px;
      line-height: 1.6;
    }

    /* Offer grid */
    #offerList {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 14px;
    }

    .offer-card {
      background: #fff;
      border-radius: 10px;
      padding: 10px;
      cursor: pointer;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
      transition: transform 0.2s ease;
      display: flex;
      align-items: center;
    }

    .offer-card:hover {
      transform: scale(1.02);
    }

    .offer-card img {
      width: 30%;
      height: 90px;
      object-fit: cover;
      border-radius: 8px;
      margin-left: 10px; /* spacing for RTL */
      flex-shrink: 0;
    }

    .offer-text {
      width: 70%;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .offer-title {
      font-size: 14px;
      font-weight: bold;
      margin-bottom: 4px;
      white-space: normal;
      overflow: visible;
    }

    .offer-desc {
      font-size: 12px;
      color: #555;
      white-space: normal;
      overflow: visible;
    }

    #loading {
      text-align: center;
      margin-top: 20px;
      font-size: 16px;
    }

    /* Responsive fallback */
    @media (max-width: 1000px) {
      #offerList {
        grid-template-columns: repeat(3, 1fr);
      }
    }

    @media (max-width: 700px) {
      #offerList {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 400px) {
      #offerList {
        grid-template-columns: 1fr;
      }
      .offer-card {
        flex-direction: column;
        align-items: flex-start;
      }
      .offer-card img {
        width: 100%;
        margin-left: 0;
        margin-bottom: 10px;
      }
      .offer-text {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <main>
    <!-- Flag -->
    <div id="flagContainer">
      <img src="https://upload.wikimedia.org/wikipedia/commons/0/00/Flag_of_Palestine.svg" alt="علم فلسطين">
    </div>

    <!-- Info Box -->
    <div id="infoBox">
      السلام عليكم، قمت بالانضمام إلى برنامج إلكتروني يتيح لأي شخص عرض خدمات بعض الشركات والمواقع الإلكترونية، كما ترون أسفله، وستقوم بمكافأتي مادياً عند تسجيلكم في خدماتها من طرفي، الأمر مجاني ولا يتطلب أكثر من دقيقة، كلما تسجلتم في خدمات أكثر كلما استفدت أنا أكثر، وأرجو منكم الدعاء لأمي وأبي بالمغفرة.
    </div>

    <div id="offerList"></div>
    <div id="loading">...</div>
  </main>

  <script>
    const offerList = document.getElementById("offerList");
    const loading = document.getElementById("loading");

    const apiKey = "34829|nJfCK9PNtqv8s0cqEl943LhDfd3ufQMGcNc2ZdCT429ec4af";

    function createOfferCard(offer) {
      const card = document.createElement("div");
      card.className = "offer-card";

      const img = document.createElement("img");
      img.src = offer.picture || "";
      card.appendChild(img);

      const textContainer = document.createElement("div");
      textContainer.className = "offer-text";

      const title = document.createElement("div");
      title.className = "offer-title";
      title.textContent = offer.name_short || offer.name;
      textContainer.appendChild(title);

      const desc = document.createElement("div");
      desc.className = "offer-desc";
      desc.textContent =
        offer.adcopy ||
        offer.description ||
        "Complete this offer to earn rewards!";
      textContainer.appendChild(desc);

      card.appendChild(textContainer);

      card.onclick = () => window.open(offer.link, "_blank");

      return card;
    }

    async function fetchOffers() {
      try {
        const ipResponse = await fetch("https://api.ipify.org?format=json");
        const ipData = await ipResponse.json();
        const userIp = ipData.ip;
        const userAgent = navigator.userAgent;

        const apiUrl = new URL("https://unlockcontent.net/api/v2");
        apiUrl.searchParams.append("ip", userIp);
        apiUrl.searchParams.append("user_agent", userAgent);
        apiUrl.searchParams.append("limit", "1000");
        apiUrl.searchParams.append("ctype", "0");

        const response = await fetch(apiUrl, {
          headers: {
            Authorization: `Bearer ${apiKey}`,
          },
        });

        if (!response.ok)
          throw new Error(`HTTP error! Status: ${response.status}`);

        const data = await response.json();
        loading.style.display = "none";

        if (!data.offers || !data.offers.length) {
          offerList.innerHTML = "<p>No offers available right now.</p>";
          return;
        }

        const sortedOffers = data.offers.sort(
          (a, b) => parseFloat(b.payout) - parseFloat(a.payout)
        );

        sortedOffers.forEach((offer) => {
          const card = createOfferCard(offer);
          offerList.appendChild(card);
        });
      } catch (error) {
        console.error("Error fetching offers:", error);
        loading.textContent = "Failed to load offers: " + error.message;
      }
    }

    fetchOffers();
  </script>
</body>
</html>
